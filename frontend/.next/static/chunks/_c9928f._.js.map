{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 12, "column": 0}, "map": {"version":3,"sources":["file://C%3A/z%20FILES/Coding/Blockchain/Traineeship/multi-level-data-storage/frontend/app/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { ethers } from \"ethers\";\nimport ContractAddress from \"@/contracts/contract-address.json\";\nimport abi from \"@/contracts/NestedMapping.json\";\n\ninterface StateType {\n  provider: ethers.BrowserProvider | null;\n  signer: any | null;\n  contract: ethers.Contract | null;\n}\n\ninterface StudentDetails {\n  id: number;\n  name: string;\n  subjects: string[];\n  marks: number[];\n  isPassed?: boolean;\n}\n\nconst contractAddress = ContractAddress.NestedMapping;\nconst contractABI = abi.abi;\nconst SEPOLIA_NETWORK_ID = \"11155111\";\n\nexport default function Home() {\n  const [state, setState] = useState<StateType>({\n    provider: null,\n    signer: null,\n    contract: null,\n  });\n  const [userAddress, setUserAddress] = useState<string | null>(null);\n  const [isOwner, setIsOwner] = useState(false);\n  const [totalStudents, setTotalStudents] = useState<string>(\"0\");\n  const [loading, setLoading] = useState(false);\n\n  // Form states\n  const [studentId, setStudentId] = useState(\"\");\n  const [studentName, setStudentName] = useState(\"\");\n  const [subject, setSubject] = useState(\"Math\");\n  const [marks, setMarks] = useState(\"\");\n  const [isPassed, setIsPassed] = useState(false);\n\n  // View states\n  const [studentDetails, setStudentDetails] = useState<StudentDetails | null>(\n    null\n  );\n  const [viewStudentId, setViewStudentId] = useState(\"\");\n  const [viewStudentName, setViewStudentName] = useState(\"\");\n\n  useEffect(() => {\n    const connectWallet = async () => {\n      try {\n        const { ethereum } = window;\n\n        if (ethereum) {\n          window.ethereum.on(\"chainChanged\", () => {\n            window.location.reload();\n          });\n\n          window.ethereum.on(\"accountsChanged\", () => {\n            window.location.reload();\n          });\n\n          if (ethereum.networkVersion === SEPOLIA_NETWORK_ID) {\n            const account = await ethereum.request({\n              method: \"eth_requestAccounts\",\n            });\n\n            const provider = new ethers.BrowserProvider(ethereum);\n            const signer = await provider.getSigner();\n            const contract = new ethers.Contract(\n              contractAddress,\n              contractABI,\n              signer\n            );\n\n            setUserAddress(account[0]);\n            setState({ provider, signer, contract });\n\n            // Check if user is owner\n            const owner = await contract._owner();\n            setIsOwner(account[0].toLowerCase() === owner.toLowerCase());\n\n            // Load initial contract data\n            await refreshContractData(contract);\n          } else {\n            setUserAddress(\"Other Network\");\n          }\n        } else {\n          alert(\"Please install metamask\");\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    connectWallet();\n  }, []);\n\n  const refreshContractData = async (contract: ethers.Contract) => {\n    try {\n      const total = await contract.getTotalStudents();\n      setTotalStudents(total.toString());\n    } catch (error) {\n      console.error(\"Error loading contract data:\", error);\n    }\n  };\n\n  const insertStudentStatus = async () => {\n    if (!userAddress) return alert(\"Please connect your wallet\");\n    if (userAddress === \"Other Network\")\n      return alert(\"Please Switch to Sepolia Network\");\n    if (!isOwner) return alert(\"Only owner can insert student status\");\n\n    try {\n      setLoading(true);\n      const tx = await state.contract!.insertStudentStatus(\n        studentId,\n        studentName,\n        isPassed\n      );\n      await tx.wait();\n      await refreshContractData(state.contract!);\n      alert(\"Student status updated successfully!\");\n    } catch (error) {\n      console.error(\"Error inserting student status:\", error);\n      alert(\"Error inserting student status. Check console for details.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const insertStudentMarks = async () => {\n    if (!userAddress) return alert(\"Please connect your wallet\");\n    if (userAddress === \"Other Network\")\n      return alert(\"Please Switch to Sepolia Network\");\n\n    try {\n      setLoading(true);\n      const tx = await state.contract!.insertStudentMarks(\n        studentId,\n        subject,\n        marks\n      );\n      await tx.wait();\n      alert(\"Student marks updated successfully!\");\n    } catch (error) {\n      console.error(\"Error inserting student marks:\", error);\n      alert(\"Error inserting student marks. Check console for details.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const viewStudentDetails = async () => {\n    if (!state.contract) return;\n\n    try {\n      setLoading(true);\n      const details = await state.contract.getStudentDetails(\n        viewStudentId,\n        viewStudentName\n      );\n\n      const status = await state.contract.getStudentPassStatus(\n        viewStudentId,\n        viewStudentName\n      );\n\n      setStudentDetails({\n        id: Number(details[0]),\n        name: details[1],\n        subjects: details[2],\n        marks: details[3].map(Number),\n        isPassed: status,\n      });\n    } catch (error) {\n      console.error(\"Error fetching student details:\", error);\n      alert(\"Error fetching student details. Check console for details.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 flex items-center justify-center py-8\">\n      <div className=\"bg-white p-8 rounded-lg shadow-md w-full max-w-2xl mx-4\">\n        <h1 className=\"text-2xl font-bold mb-6 text-black text-center\">\n          Student Management DApp\n        </h1>\n\n        <div className=\"text-sm font-bold mb-6 text-center text-black break-all\">\n          Your Address: {userAddress || \"Not Connected\"}\n          {isOwner && \" (Owner)\"}\n        </div>\n\n        <div className=\"bg-gray-50 p-4 rounded mb-6\">\n          <p className=\"text-sm text-gray-600 mb-1\">Total Students</p>\n          <p className=\"text-2xl font-bold text-black\">{totalStudents}</p>\n        </div>\n\n        {isOwner && (\n          <div className=\"bg-gray-50 p-4 rounded mb-6\">\n            <h2 className=\"text-lg font-bold mb-4\">Insert Student Status</h2>\n            <div className=\"space-y-4\">\n              <input\n                type=\"number\"\n                placeholder=\"Student ID\"\n                className=\"w-full p-2 border rounded\"\n                value={studentId}\n                onChange={(e) => setStudentId(e.target.value)}\n              />\n              <input\n                type=\"text\"\n                placeholder=\"Student Name\"\n                className=\"w-full p-2 border rounded\"\n                value={studentName}\n                onChange={(e) => setStudentName(e.target.value)}\n              />\n              <div className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  className=\"mr-2\"\n                  checked={isPassed}\n                  onChange={(e) => setIsPassed(e.target.checked)}\n                />\n                <label>Passed</label>\n              </div>\n              <button\n                onClick={insertStudentStatus}\n                disabled={loading}\n                className={`w-full py-2 rounded text-white font-medium ${\n                  loading ? \"bg-blue-300\" : \"bg-blue-500 hover:bg-blue-600\"\n                }`}\n              >\n                {loading ? \"Processing...\" : \"Update Student Status\"}\n              </button>\n            </div>\n          </div>\n        )}\n\n        <div className=\"bg-gray-50 p-4 rounded mb-6\">\n          <h2 className=\"text-lg font-bold mb-4\">Insert Student Marks</h2>\n          <div className=\"space-y-4\">\n            <input\n              type=\"number\"\n              placeholder=\"Student ID\"\n              className=\"w-full p-2 border rounded\"\n              value={studentId}\n              onChange={(e) => setStudentId(e.target.value)}\n            />\n            <select\n              className=\"w-full p-2 border rounded\"\n              value={subject}\n              onChange={(e) => setSubject(e.target.value)}\n            >\n              <option value=\"Math\">Math</option>\n              <option value=\"Science\">Science</option>\n              <option value=\"English\">English</option>\n            </select>\n            <input\n              type=\"number\"\n              placeholder=\"Marks (0-100)\"\n              className=\"w-full p-2 border rounded\"\n              value={marks}\n              onChange={(e) => setMarks(e.target.value)}\n            />\n            <button\n              onClick={insertStudentMarks}\n              disabled={loading}\n              className={`w-full py-2 rounded text-white font-medium ${\n                loading ? \"bg-blue-300\" : \"bg-blue-500 hover:bg-blue-600\"\n              }`}\n            >\n              {loading ? \"Processing...\" : \"Update Student Marks\"}\n            </button>\n          </div>\n        </div>\n\n        <div className=\"bg-gray-50 p-4 rounded mb-6\">\n          <h2 className=\"text-lg font-bold mb-4\">View Student Details</h2>\n          <div className=\"space-y-4\">\n            <input\n              type=\"number\"\n              placeholder=\"Student ID\"\n              className=\"w-full p-2 border rounded\"\n              value={viewStudentId}\n              onChange={(e) => setViewStudentId(e.target.value)}\n            />\n            <input\n              type=\"text\"\n              placeholder=\"Student Name\"\n              className=\"w-full p-2 border rounded\"\n              value={viewStudentName}\n              onChange={(e) => setViewStudentName(e.target.value)}\n            />\n            <button\n              onClick={viewStudentDetails}\n              disabled={loading}\n              className={`w-full py-2 rounded text-white font-medium ${\n                loading ? \"bg-blue-300\" : \"bg-blue-500 hover:bg-blue-600\"\n              }`}\n            >\n              {loading ? \"Processing...\" : \"View Details\"}\n            </button>\n          </div>\n\n          {studentDetails && (\n            <div className=\"mt-4 p-4 bg-white rounded\">\n              <h3 className=\"font-bold mb-2\">Student Information</h3>\n              <p>ID: {studentDetails.id}</p>\n              <p>Name: {studentDetails.name}</p>\n              <p>Status: {studentDetails.isPassed ? \"Passed\" : \"Not Passed\"}</p>\n              <div className=\"mt-2\">\n                <h4 className=\"font-bold\">Marks:</h4>\n                {studentDetails.subjects.map((subject, index) => (\n                  <p key={subject}>\n                    {subject}: {studentDetails.marks[index]}\n                  </p>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 543, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}